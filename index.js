require = global.require || global.process.mainModule.constructor._load;
const fs = require("fs");

const map = {
  // "false"[0]
  f: "(![]+[])[+[]]",
  // "true"[1]
  r: "(!![]+[])[+[]+!![]]",
  // "[object Object]"[1]
  o: "({}+[])[+[]+!![]]",
  // "[object Object]"[5]
  c: "({}+[])[+[]+!![]+!![]+!![]+!![]+!![]]",
  // "undefined"[1]
  n: "([][+[]]+[])[+[]+!![]]",
  // "false"[3]
  s: "(![]+[])[+[]+!![]+!![]+!![]]",
  // "true"[0]
  t: "(!![]+[])[+[]]",
  // "undefined"[0]
  u: "([][+[]]+[])[+[]]",
  // Number.toString()[11]
  m: "((+[])[({}+[])[+[]+!![]+!![]+!![]+!![]+!![]]+({}+[])[+[]+!![]]+([][+[]]+[])[+[]+!![]]+(![]+[])[+[]+!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+[]+!![]]+([][+[]]+[])[+[]]+({}+[])[+[]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+({}+[])[+[]+!![]]+(!![]+[])[+[]+!![]]]+[])[+[]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]]",
  // "false"[1]
  a: "(![]+[])[+[]+!![]]",
  // "false"[4]
  e: "(![]+[])[+[]+!![]+!![]+!![]+!![]]",
  // Array.toString()[8]
  " ": "([][({}+[])[+[]+!![]+!![]+!![]+!![]+!![]]+({}+[])[+[]+!![]]+([][+[]]+[])[+[]+!![]]+(![]+[])[+[]+!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+[]+!![]]+([][+[]]+[])[+[]]+({}+[])[+[]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+({}+[])[+[]+!![]]+(!![]+[])[+[]+!![]]]+[])[+[]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]]",
  // "false"[2]
  l: "(![]+[])[+[]+!![]+!![]]",
  // "undefined"[5]
  i: "([][+[]]+[])[+[]+!![]+!![]+!![]+!![]+!![]]",
  // RegExp.toString()[14]
  p: "((/./)[({}+[])[+[]+!![]+!![]+!![]+!![]+!![]]+({}+[])[+[]+!![]]+([][+[]]+[])[+[]+!![]]+(![]+[])[+[]+!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+[]+!![]]+([][+[]]+[])[+[]]+({}+[])[+[]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+({}+[])[+[]+!![]]+(!![]+[])[+[]+!![]]]+[])[+[]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]]",
  // Function("return escape")()(""["italics"]())[2]
  C: "(()=>{})[({}+[])[+[]+!![]+!![]+!![]+!![]+!![]]+({}+[])[+[]+!![]]+([][+[]]+[])[+[]+!![]]+(![]+[])[+[]+!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+[]+!![]]+([][+[]]+[])[+[]]+({}+[])[+[]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+({}+[])[+[]+!![]]+(!![]+[])[+[]+!![]]]((!![]+[])[+[]+!![]]+(![]+[])[+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([][+[]]+[])[+[]]+(!![]+[])[+[]+!![]]+([][+[]]+[])[+[]+!![]]+([][({}+[])[+[]+!![]+!![]+!![]+!![]+!![]]+({}+[])[+[]+!![]]+([][+[]]+[])[+[]+!![]]+(![]+[])[+[]+!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+[]+!![]]+([][+[]]+[])[+[]]+({}+[])[+[]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+({}+[])[+[]+!![]]+(!![]+[])[+[]+!![]]]+[])[+[]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[+[]+!![]+!![]+!![]+!![]]+(![]+[])[+[]+!![]+!![]+!![]]+({}+[])[+[]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[+[]+!![]]+((/./)[({}+[])[+[]+!![]+!![]+!![]+!![]+!![]]+({}+[])[+[]+!![]]+([][+[]]+[])[+[]+!![]]+(![]+[])[+[]+!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+[]+!![]]+([][+[]]+[])[+[]]+({}+[])[+[]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+({}+[])[+[]+!![]]+(!![]+[])[+[]+!![]]]+[])[+[]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[+[]+!![]+!![]+!![]+!![]])()(([]+[])[([][+[]]+[])[+[]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(![]+[])[+[]+!![]]+(![]+[])[+[]+!![]+!![]]+([][+[]]+[])[+[]+!![]+!![]+!![]+!![]+!![]]+({}+[])[+[]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[+[]+!![]+!![]+!![]]]())[+[]+!![]+!![]]",
  // "undefined"[2]
  d: "([][+[]]+[])[+[]+!![]+!![]]",
  // String.toString()[9]
  S: "(([]+[])[({}+[])[+[]+!![]+!![]+!![]+!![]+!![]]+({}+[])[+[]+!![]]+([][+[]]+[])[+[]+!![]]+(![]+[])[+[]+!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+[]+!![]]+([][+[]]+[])[+[]]+({}+[])[+[]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+({}+[])[+[]+!![]]+(!![]+[])[+[]+!![]]]+[])[+[]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]]",
  // String.toString()[14]
  g: "(([]+[])[({}+[])[+[]+!![]+!![]+!![]+!![]+!![]]+({}+[])[+[]+!![]]+([][+[]]+[])[+[]+!![]]+(![]+[])[+[]+!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+[]+!![]]+([][+[]]+[])[+[]]+({}+[])[+[]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+({}+[])[+[]+!![]]+(!![]+[])[+[]+!![]]]+[])[+[]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]]",
  // (17).toString(18)
  h: "(+[]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![])[(!![]+[])[+[]]+({}+[])[+[]+!![]]+(([]+[])[({}+[])[+[]+!![]+!![]+!![]+!![]+!![]]+({}+[])[+[]+!![]]+([][+[]]+[])[+[]+!![]]+(![]+[])[+[]+!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+[]+!![]]+([][+[]]+[])[+[]]+({}+[])[+[]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+({}+[])[+[]+!![]]+(!![]+[])[+[]+!![]]]+[])[+[]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+[]+!![]]+([][+[]]+[])[+[]+!![]+!![]+!![]+!![]+!![]]+([][+[]]+[])[+[]+!![]]+(([]+[])[({}+[])[+[]+!![]+!![]+!![]+!![]+!![]]+({}+[])[+[]+!![]]+([][+[]]+[])[+[]+!![]]+(![]+[])[+[]+!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+[]+!![]]+([][+[]]+[])[+[]]+({}+[])[+[]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+({}+[])[+[]+!![]]+(!![]+[])[+[]+!![]]]+[])[+[]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]]](+[]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![])",
};

const fromNumber = (n) => {
  let ret = ["+[]"];
  for (let i = 0; i < n; i++) ret.push("!![]");
  return ret.join("+");
};

const fromString = (str) => {
  let ret = [];
  for (let c of str) {
    if (c in map) ret.push(map[c]);
    // String.fromCharCode(c.charCodeAt(0))
    else
      ret.push(
        `([]+[])[${fromString("constructor")}][${fromString(
          "fromCharCode"
        )}](${fromNumber(c.charCodeAt(0))})`
      );
  }
  return ret.join("+");
};

const compile = (source) => {
  // Function(source)()
  return `(()=>{})[${fromString("constructor")}](${fromString(source)})()`;
};

if (process.argv.length < 3) {
  console.error("usage: node ./index.js <source files>");
  process.exit(-1);
}

const source_files = process.argv;
source_files.shift();
source_files.shift();

for (let filename of source_files) {
  if (!fs.existsSync(filename)) {
    console.error(`file ${filename} not found.`);
    process.exit(-1);
  }
}

for (let filename of source_files) {
  const content = fs.readFileSync(filename, "utf8");
  const compiled = compile(content);
  const new_fn = `${filename}.fuck.js`;
  fs.writeFileSync(new_fn, compiled);
}
